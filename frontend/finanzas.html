<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Finanzas Personales</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .error { color: red; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Finanzas Personales</h1>
    <div id="mensaje"></div>
    <table id="tabla-finanzas">
        <thead>
            <tr>
                <th>ID</th>
                <th>Fecha</th>
                <th>Descripción</th>
                <th>Categoría</th>
                <th>Monto</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        async function cargarFinanzas() {
            const mensajeDiv = document.getElementById('mensaje');
            const tbody = document.querySelector('#tabla-finanzas tbody');
            
            try {
                const response = await fetch('http://localhost:3000/finanzas');
                if (!response.ok) throw new Error(`Error HTTP: ${response.status}`);
                
                const data = await response.json();
                mensajeDiv.innerHTML = '';
                tbody.innerHTML = '';
                
                if (data.length === 0) {
                    mensajeDiv.innerHTML = '<p>No hay registros.</p>';
                    return;
                }
                
                data.forEach(item => {
                    const fila = document.createElement('tr');
                    fila.innerHTML = `
                        <td>${item.id}</td>
                        <td>${item.fecha}</td>
                        <td>${item.descripcion}</td>
                        <td>${item.categoria || '-'}</td>
                        <td>$${parseFloat(item.monto).toFixed(2)}</td>
                    `;
                    tbody.appendChild(fila);
                });
            } catch (error) {
                mensajeDiv.innerHTML = `<p class="error">Error al cargar datos: ${error.message}</p>`;
            }
        }
        
        cargarFinanzas();
    </script>
</body>
</html>
